<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Practice - UTERNITY</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%237c3aed'><path d='M12 4L4 8L12 12L20 8L12 4Z'/><path d='M4 12L12 16L20 12'/><path d='M4 16L12 20L20 16'/></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Smooth page transitions */
        .page-transition {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .page-transition.loaded {
            opacity: 1;
            transform: translateY(0);
        }

        /* Smooth navigation transitions */
        .nav-link {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Page content fade-in animation */
        .main-container {
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Hide scrollbars for all elements */
        * {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
        }
        
        *::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        /* Header styling - EXACT same as other pages */
        #header-container {
            position: relative;
            z-index: 1000;
            width: 100%;
        }

        .header-container {
            position: relative;
            z-index: 50;
            padding: 1rem;
            margin-bottom: 0;
        }

        .header-nav {
            background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
            border-radius: 24px;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 10px 16px;
            border-radius: 12px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .nav-link:hover {
            color: white;
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
        }

        .nav-link.active {
            color: white;
            background: rgba(255, 255, 255, 0.25);
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2);
        }

        .nav-link i {
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .nav-link:hover i {
            transform: scale(1.1);
        }

        .nav-link.active i {
            transform: scale(1.1);
        }

        /* Main container */
        .main-container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Modern Section Headers */
        .modern-header {
            margin-bottom: 2.344rem;
            text-align: center;
            position: relative;
        }

        .header-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem 3rem;
            border-radius: 40px;
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            margin-bottom: 0;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .modern-title {
            font-family: 'Inter', sans-serif;
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin: 0 0 1rem 0;
            letter-spacing: -0.03em;
            line-height: 1.1;
        }

        .modern-subtitle {
            font-family: 'Inter', sans-serif;
            font-size: 1.25rem;
            font-weight: 400;
            color: #6b7280;
            margin: 0;
            line-height: 1.5;
            max-width: 500px;
            margin: 0 auto;
        }

        /* Stats cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(226, 232, 240, 0.8);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.15);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
            color: white;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }

        /* Full test cards */
        .full-test-section {
            margin-bottom: 2rem;
        }

        .full-test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
        }

        .full-test-card {
            background: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
            color: white;
            border-radius: 20px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 2px solid transparent;
        }

        .full-test-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .full-test-card:hover::before {
            left: 100%;
        }

        .full-test-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.3);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .full-test-badge {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .full-test-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .full-test-subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        .full-test-details {
            font-size: 0.875rem;
            opacity: 0.8;
            line-height: 1.5;
        }

        /* Individual section cards */
        .individual-sections {
            margin-bottom: 2rem;
        }

        .section-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 1rem;
            margin-top: 1.5rem;
        }

        .section-tab {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .section-tab.active {
            background: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
            color: white;
        }

        .section-tab:not(.active) {
            background: white;
            color: #6b7280;
            border-color: #e2e8f0;
        }

        .section-tab:hover:not(.active) {
            border-color: #8b5cf6;
            color: #8b5cf6;
        }

        .history-tab {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .history-tab i {
            font-size: 14px;
        }

        .section-content {
            display: none;
        }

        .section-content.active {
            display: block;
        }

        .section-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .individual-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(226, 232, 240, 0.8);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .ielts-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(226, 232, 240, 0.8);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .individual-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.15);
            border-color: #8b5cf6;
        }

        .individual-card-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .individual-card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            color: white;
        }

        .toefl-icon {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }

        .ielts-icon {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
        }

        .individual-card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }

        .individual-card-subtitle {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .individual-card-description {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .practice-button {
            background: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .practice-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* History Section Styles */
        .history-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .history-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
        }

        .history-card {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(226, 232, 240, 0.8);
            transition: all 0.3s ease;
        }

        .history-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.15);
        }

        .history-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .test-info {
            display: flex;
            flex-direction: column;
        }

        .test-type {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.25rem;
        }

        .test-date {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .score-badge {
            background: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .score {
            font-size: 1.25rem;
        }

        .max-score {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        .history-card-content {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .performance-metrics {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .metric {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .metric-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            min-width: 100px;
        }

        .metric-bar {
            flex: 1;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
        }

        .metric-fill {
            height: 100%;
            background: linear-gradient(90deg, #8b5cf6 0%, #06b6d4 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .metric-value {
            font-size: 0.875rem;
            font-weight: 600;
            color: #1f2937;
            min-width: 40px;
            text-align: right;
        }

        .ai-recommendations {
            background: #f8fafc;
            border-radius: 12px;
            padding: 1rem;
            border-left: 4px solid #8b5cf6;
        }

        .recommendations-title {
            font-size: 1rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.75rem;
        }

        .recommendations-list {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .recommendations-list li {
            font-size: 0.875rem;
            color: #374151;
            line-height: 1.4;
            padding-left: 0;
        }
    </style>
</head>
<body>
    <!-- Header - EXACT same as other pages -->
    <div id="header-container">
        <!-- Header will be loaded here -->
    </div>

    <!-- Main Container -->
    <div class="main-container">




        <!-- Full Test Section -->
        <div class="full-test-section">
            <div class="modern-header">
                <div class="text-5xl font-black tracking-tight text-center">
                    <span class="bg-gradient-to-r from-purple-600 via-pink-500 to-purple-600 bg-clip-text text-transparent">
                        Complete English
                    </span>
                    <span class="bg-gradient-to-r from-purple-600 via-pink-500 to-purple-600 bg-clip-text text-transparent ml-2">Proficiency Test</span>
                </div>
            </div>
            
            <div class="full-test-grid">
                <div class="full-test-card" onclick="goToToeflTests()">
                    <div class="full-test-badge">7 TEST SETS</div>
                    <div class="full-test-title">TOEFL Speaking Tests</div>
                    <div class="full-test-subtitle">Choose from 7 different test sets • Track progress</div>
                    <div class="full-test-details">
                        • 7 Complete Test Variations<br>
                        • Detailed Score Analysis<br>
                        • Progress Tracking<br>
                        • TOEFL Score Prediction
                    </div>
                </div>



                <div class="full-test-card" onclick="startFullTest('ielts')">
                    <div class="full-test-badge">FULL TEST</div>
                    <div class="full-test-title">IELTS Speaking Test</div>
                    <div class="full-test-subtitle">Complete all 3 parts • 11-14 minutes</div>
                    <div class="full-test-details">
                        • Introduction & Interview<br>
                        • Long Turn Presentation<br>
                        • Two-way Discussion
                    </div>
                </div>
            </div>
        </div>

        <!-- Individual Sections -->
        <div class="individual-sections">
            <div class="modern-header" style="margin-top: 2rem;">
                <div class="text-5xl font-black tracking-tight text-center">
                    <span class="bg-gradient-to-r from-purple-600 via-pink-500 to-purple-600 bg-clip-text text-transparent">
                        Modular Testing
                    </span>
                </div>
            </div>

            <div class="section-tabs">
                <div class="section-tab active" onclick="switchTab('toefl')">TOEFL Sections</div>
                <div class="section-tab" onclick="switchTab('ielts')">IELTS Sections</div>
                <div class="section-tab history-tab" onclick="showHistory()">
                    <i class="fas fa-history"></i>
                    History
                </div>
            </div>

            <!-- TOEFL Sections -->
            <div class="section-content active" id="toefl-content">
                <div class="section-grid">
                    <div class="individual-card" onclick="startIndividualTest('toefl', 'independent')">
                        <div class="individual-card-header">
                            <div class="individual-card-icon toefl-icon">
                                <i class="fas fa-microphone"></i>
                            </div>
                            <div>
                                <div class="individual-card-title">Independent Speaking</div>
                                <div class="individual-card-subtitle">Task 1 • 15 seconds prep, 45 seconds speak</div>
                            </div>
                        </div>
                        <div class="individual-card-description">
                            Express your opinion on familiar topics. Practice giving clear, well-structured responses.
                        </div>
                        <button class="practice-button">Start Practice</button>
                    </div>

                    <div class="individual-card" onclick="startIndividualTest('toefl', 'campus')">
                        <div class="individual-card-header">
                            <div class="individual-card-icon toefl-icon">
                                <i class="fas fa-university"></i>
                            </div>
                            <div>
                                <div class="individual-card-title">Campus Situation</div>
                                <div class="individual-card-subtitle">Task 2 • 30 seconds prep, 60 seconds speak</div>
                            </div>
                        </div>
                        <div class="individual-card-description">
                            Respond to campus-related conversations and express your opinion clearly.
                        </div>
                        <button class="practice-button">Start Practice</button>
                    </div>

                    <div class="individual-card" onclick="startIndividualTest('toefl', 'academic-course')">
                        <div class="individual-card-header">
                            <div class="individual-card-icon toefl-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div>
                                <div class="individual-card-title">Academic Course</div>
                                <div class="individual-card-subtitle">Task 3 • 30 seconds prep, 60 seconds speak</div>
                            </div>
                        </div>
                        <div class="individual-card-description">
                            Summarize academic content and express your understanding of course material.
                        </div>
                        <button class="practice-button">Start Practice</button>
                    </div>

                    <div class="individual-card" onclick="startIndividualTest('toefl', 'academic-lecture')">
                        <div class="individual-card-header">
                            <div class="individual-card-icon toefl-icon">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <div>
                                <div class="individual-card-title">Academic Lecture</div>
                                <div class="individual-card-subtitle">Task 4 • 20 seconds prep, 60 seconds speak</div>
                            </div>
                        </div>
                        <div class="individual-card-description">
                            Summarize lecture content and demonstrate understanding of academic concepts.
                        </div>
                        <button class="practice-button">Start Practice</button>
                    </div>
                </div>
            </div>

            <!-- IELTS Sections -->
            <div class="section-content" id="ielts-content">
                <div class="section-grid">
                    <div class="ielts-card" onclick="startIndividualTest('ielts', 'interview')">
                        <div class="individual-card-header">
                            <div class="individual-card-icon toefl-icon">
                                <i class="fas fa-microphone"></i>
                            </div>
                            <div>
                                <div class="individual-card-title">Introduction & Interview</div>
                                <div class="individual-card-subtitle">Part 1 • 4-5 minutes</div>
                            </div>
                        </div>
                        <div class="individual-card-description">
                            Answer questions about familiar topics like family, work, studies, and interests.
                        </div>
                        <button class="practice-button">Start Practice</button>
                    </div>

                    <div class="ielts-card" onclick="startIndividualTest('ielts', 'presentation')">
                        <div class="individual-card-header">
                            <div class="individual-card-icon toefl-icon">
                                <i class="fas fa-university"></i>
                            </div>
                            <div>
                                <div class="individual-card-title">Long Turn Presentation</div>
                                <div class="individual-card-subtitle">Part 2 • 3-4 minutes</div>
                            </div>
                        </div>
                        <div class="individual-card-description">
                            Speak for 2 minutes on a given topic with 1 minute preparation time.
                        </div>
                        <button class="practice-button">Start Practice</button>
                    </div>

                    <div class="ielts-card" onclick="startIndividualTest('ielts', 'discussion')">
                        <div class="individual-card-header">
                            <div class="individual-card-icon toefl-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div>
                                <div class="individual-card-title">Two-way Discussion</div>
                                <div class="individual-card-subtitle">Part 3 • 4-5 minutes</div>
                            </div>
                        </div>
                        <div class="individual-card-description">
                            Engage in a deeper discussion about abstract ideas and concepts.
                        </div>
                        <button class="practice-button">Start Practice</button>
                    </div>
                </div>
            </div>

            <!-- History Section -->
            <div class="section-content" id="history-content">
                <div class="history-container">
                    <div class="history-header">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Test History & Analytics</h3>
                        <p class="text-gray-600 mb-6">Review your past test performances and AI recommendations</p>
                    </div>
                    
                    <div class="history-grid">
                        <!-- Sample History Card 1 -->
                        <div class="history-card">
                            <div class="history-card-header">
                                <div class="test-info">
                                    <div class="test-type">TOEFL Speaking</div>
                                    <div class="test-date">December 15, 2024</div>
                                </div>
                                <div class="score-badge">
                                    <span class="score">85</span>
                                    <span class="max-score">/100</span>
                                </div>
                            </div>
                            <div class="history-card-content">
                                <div class="performance-metrics">
                                    <div class="metric">
                                        <span class="metric-label">Fluency</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 85%"></div>
                                        </div>
                                        <span class="metric-value">85%</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">Pronunciation</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 78%"></div>
                                        </div>
                                        <span class="metric-value">78%</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">Grammar</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 92%"></div>
                                        </div>
                                        <span class="metric-value">92%</span>
                                    </div>
                                </div>
                                <div class="ai-recommendations">
                                    <h4 class="recommendations-title">AI Recommendations</h4>
                                    <ul class="recommendations-list">
                                        <li>✅ Excellent grammar usage and sentence structure</li>
                                        <li>✅ Clear pronunciation and good pacing</li>
                                        <li>⚠️ Work on reducing filler words ("um", "uh")</li>
                                        <li>💡 Practice more complex vocabulary in context</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Sample History Card 2 -->
                        <div class="history-card">
                            <div class="history-card-header">
                                <div class="test-info">
                                    <div class="test-type">IELTS Speaking</div>
                                    <div class="test-date">December 10, 2024</div>
                                </div>
                                <div class="score-badge">
                                    <span class="score">7.5</span>
                                    <span class="max-score">/9.0</span>
                                </div>
                            </div>
                            <div class="history-card-content">
                                <div class="performance-metrics">
                                    <div class="metric">
                                        <span class="metric-label">Fluency</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 80%"></div>
                                        </div>
                                        <span class="metric-value">80%</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">Pronunciation</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 85%"></div>
                                        </div>
                                        <span class="metric-value">85%</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">Grammar</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 88%"></div>
                                        </div>
                                        <span class="metric-value">88%</span>
                                    </div>
                                </div>
                                <div class="ai-recommendations">
                                    <h4 class="recommendations-title">AI Recommendations</h4>
                                    <ul class="recommendations-list">
                                        <li>✅ Strong vocabulary and idiomatic expressions</li>
                                        <li>✅ Good use of complex sentence structures</li>
                                        <li>⚠️ Improve intonation patterns for better clarity</li>
                                        <li>💡 Practice more academic vocabulary for Part 3</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Sample History Card 3 -->
                        <div class="history-card">
                            <div class="history-card-header">
                                <div class="test-info">
                                    <div class="test-type">TOEFL Independent Speaking</div>
                                    <div class="test-date">December 5, 2024</div>
                                </div>
                                <div class="score-badge">
                                    <span class="score">82</span>
                                    <span class="max-score">/100</span>
                                </div>
                            </div>
                            <div class="history-card-content">
                                <div class="performance-metrics">
                                    <div class="metric">
                                        <span class="metric-label">Fluency</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 82%"></div>
                                        </div>
                                        <span class="metric-value">82%</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">Pronunciation</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 75%"></div>
                                        </div>
                                        <span class="metric-value">75%</span>
                                    </div>
                                    <div class="metric">
                                        <span class="metric-label">Grammar</span>
                                        <div class="metric-bar">
                                            <div class="metric-fill" style="width: 90%"></div>
                                        </div>
                                        <span class="metric-value">90%</span>
                                    </div>
                                </div>
                                <div class="ai-recommendations">
                                    <h4 class="recommendations-title">AI Recommendations</h4>
                                    <ul class="recommendations-list">
                                        <li>✅ Well-structured responses with clear examples</li>
                                        <li>✅ Good time management and pacing</li>
                                        <li>⚠️ Work on stress patterns in multi-syllable words</li>
                                        <li>💡 Include more specific details and examples</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================================================
        // HEADER LOADING - EXACT same as other pages
        // ============================================================================
        
        function loadHeader() {
            console.log('🔄 Loading header component...');
            
            document.getElementById('header-container').innerHTML = `
                <header class="header-container">
                    <nav class="header-nav">
                        <div class="flex items-center space-x-2">
                            <div class="w-10 h-10 bg-white rounded-xl flex items-center justify-center shadow-lg">
                                <svg class="w-6 h-6 text-purple-600" viewBox="0 0 24 24" fill="none">
                                    <path d="M12 4L4 8L12 12L20 8L12 4Z" stroke="currentColor" stroke-width="2"/>
                                    <path d="M4 12L12 16L20 12" stroke="currentColor" stroke-width="2"/>
                                    <path d="M4 16L12 20L20 16" stroke="currentColor" stroke-width="2"/>
                                </svg>
                            </div>
                            <span class="text-2xl font-bold text-white">UTERNITY</span>
                        </div>
                        <div class="flex items-center space-x-6">
                            <a href="chat.html" class="nav-link">
                                <i class="fas fa-comments"></i>
                                Chat
                            </a>
                            <a href="sop-create.html" class="nav-link">
                                <i class="fas fa-file-alt mr-2"></i>
                                SOP
                            </a>
                            <a href="cost-calculator.html" class="nav-link">
                                <i class="fas fa-calculator"></i>
                                Cost Calculator
                            </a>
                            <a href="university-recommender.html" class="nav-link">
                                <i class="fas fa-university"></i>
                                Recommend
                            </a>
                            <a href="voice-dashboard.html" class="nav-link active">
                                <i class="fas fa-graduation-cap"></i>
                                TOEFL/IELTS
                            </a>
                        </div>
                        <div class="flex items-center space-x-4">
                            
                            <div class="relative user-menu">
                                <button id="userMenuButton" class="flex items-center space-x-2 p-2 hover:bg-white hover:bg-opacity-10 rounded-lg transition-colors">
                                    <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                        <span id="userInitial" class="text-sm font-semibold text-white">?</span>
                                    </div>
                                    <span id="userDisplayName" class="text-white font-medium hidden sm:block"></span>
                                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                    </svg>
                                </button>
                                <div id="userDropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg py-2 hidden" style="z-index: 9999;">
                                    <div class="px-4 py-2 border-b border-gray-100">
                                        <p id="userDropdownName" class="text-sm font-medium text-gray-800"></p>
                                        <p id="userEmail" class="text-xs text-gray-500 mt-1"></p>
                                    </div>
                                    <a href="/profile" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                        </svg>
                                        Profile
                                    </a>
                                    <button id="logoutButton" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"/>
                                        </svg>
                                        Sign Out
                                    </button>
                                </div>
                            </div>
                        </div>
                    </nav>
                </header>
            `;
            console.log('✅ Header loaded successfully');
        }

        // Add CSS for dropdown hover functionality
        const dropdownCSS = `
            <style>
                .user-menu:hover #userDropdown {
                    display: block !important;
                }
                .user-menu #userDropdown {
                    display: none;
                }
                .user-menu:hover #userDropdown.hidden {
                    display: block !important;
                }
            </style>
        `;
        document.head.insertAdjacentHTML('beforeend', dropdownCSS);

        // Setup header dropdown functionality
        function setupHeaderDropdowns() {
            // User dropdown
            const userMenuButton = document.getElementById('userMenuButton');
            const userDropdown = document.getElementById('userDropdown');
            const logoutButton = document.getElementById('logoutButton');

            if (userMenuButton && userDropdown) {
                userMenuButton.addEventListener('click', function(e) {
                    e.stopPropagation();
                    userDropdown.classList.toggle('hidden');
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!userMenuButton.contains(e.target) && !userDropdown.contains(e.target)) {
                        userDropdown.classList.add('hidden');
                    }
                });
            }

            // Populate user initials across header
            (function populateHeaderUserInfo(){
                try {
                    // Try multiple sources for user data to be extra robust on this page
                    const candidateKeys = [
                        'uternity_user','user_data','current_user','auth_user','profile','user'
                    ];
                    let raw = null;
                    for (const k of candidateKeys){
                        raw = localStorage.getItem(k);
                        if (raw) break;
                    }
                    let user = {}; if (raw) { try { user = JSON.parse(raw); } catch { user = {}; } }

                    // Also consider plain string values that might store email/name directly
                    const fallbackEmail = localStorage.getItem('user_email') || localStorage.getItem('email') || '';
                    const fallbackName = localStorage.getItem('user_name') || localStorage.getItem('name') || '';

                    const name = user.name || user.full_name || user.fullName || user.username || fallbackName || '';
                    const email = user.email || user.user_email || fallbackEmail || '';
                    function initials(n,e){
                        if(n&&n.trim()){const p=n.trim().split(/\s+/).filter(Boolean);const f=p[0]?.[0]||'';const l=p.length>1?p[p.length-1][0]:'';return((f+l)||'?').toUpperCase();}
                        if(e&&e.trim()){const u=(e.split('@')[0]||'');const t=u.split(/[^a-zA-Z]+/).filter(Boolean);const f=t[0]?.[0]||'';const l=t.length>1?t[t.length-1][0]:'';return((f+l)||u[0]||'?').toUpperCase();}
                        return'?';
                    }
                    const init=initials(name,email);
                    const elI=document.getElementById('userInitial');
                    const elD=document.getElementById('userDisplayName');
                    const elDN=document.getElementById('userDropdownName');
                    const elE=document.getElementById('userEmail');
                    if(elI) elI.textContent=init;
                    if(elD){elD.textContent=''; elD.style.display='none';}
                    if(elDN) elDN.textContent=name||'';
                    if(elE) elE.textContent=email||'';
                } catch(e){ console.warn('populateHeaderUserInfo failed:', e); }
            })();

            // Logout functionality - UPDATED TO CLEAR ALL AUTH DATA
            if (logoutButton) {
                logoutButton.addEventListener('click', async function() {
                    if (confirm('Are you sure you want to sign out?')) {
                        console.log('🚪 Starting logout process from voice dashboard page');
                        try {
                            // Try to call our auth service logout endpoint
                            const accessToken = localStorage.getItem('uternity_access_token') || localStorage.getItem('access_token');
                            if (accessToken) {
                                try {
                                    await fetch('http://localhost:8001/auth/logout', {
                                        method: 'POST',
                                        headers: {
                                            'Authorization': `Bearer ${accessToken}`,
                                            'Content-Type': 'application/json'
                                        }
                                    });
                                    console.log('✅ Auth service logout successful from voice dashboard page');
                                } catch (error) {
                                    console.warn('⚠️ Auth service logout failed from voice dashboard page, continuing with local cleanup:', error);
                                }
                            }

                            // Clear all authentication and session data
                            const keys = [
                                'access_token','refresh_token','session_id','user_data',
                                'uternity_user','uternity_access_token','uternity_refresh_token',
                                'uternity_current_session_id','uternity_token'
                            ];
                            keys.forEach(k => localStorage.removeItem(k));
                            
                            console.log('✅ All local storage cleared from voice dashboard page');
                            window.location.href = '/auth/login';
                        } catch (error) {
                            console.error('❌ Logout failed from voice dashboard page:', error);
                            // Even if logout fails, clear local data and redirect
                            localStorage.clear();
                            window.location.href = '/auth/login';
                        }
                    }
                });
            }
        }

        // Initialize dropdown functionality
        setupHeaderDropdowns();

        // ============================================================================
        // TAB SWITCHING
        // ============================================================================

        function switchTab(testType) {
            console.log('🎮 Switching to tab:', testType);
            
            // Update tab active states
            document.querySelectorAll('.section-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update content visibility
            document.querySelectorAll('.section-content').forEach(content => {
                content.classList.remove('active');
            });
            
            if (testType === 'toefl') {
                document.getElementById('toefl-content').classList.add('active');
            } else if (testType === 'ielts') {
                document.getElementById('ielts-content').classList.add('active');
            }
        }

        function showHistory() {
            console.log('📊 Showing test history');
            
            // Update tab active states
            document.querySelectorAll('.section-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update content visibility
            document.querySelectorAll('.section-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.getElementById('history-content').classList.add('active');
        }

        // ============================================================================
        // TEST FUNCTIONS
        // ============================================================================

        function goToToeflTests() {
            console.log('🎮 Navigating to TOEFL test selection');
            
            try {
                // Show loading state
                const testCard = event.target.closest('.full-test-card');
                if (testCard) {
                    const originalContent = testCard.innerHTML;
                    testCard.innerHTML = `
                        <div class="flex items-center justify-center">
                            <div class="loading-spinner mr-3"></div>
                            <span>Loading TOEFL Tests...</span>
                        </div>
                    `;
                    
                    // Redirect after brief delay
                    setTimeout(() => {
                        window.location.href = '/toefl-tests';
                    }, 1000);
                }
                
            } catch (error) {
                console.error('❌ Failed to navigate to TOEFL tests:', error);
                alert(`Error: ${error.message || 'Failed to load TOEFL tests'}. Please try again.`);
            }
        }



        function startFullTest(testType) {
            console.log('🎮 Starting full test:', testType);
            
            try {
                // Show loading state
                const testCard = event.target.closest('.full-test-card');
                if (testCard) {
                    const originalContent = testCard.innerHTML;
                    testCard.innerHTML = `
                        <div class="flex items-center justify-center">
                            <div class="loading-spinner mr-3"></div>
                            <span>Loading ${testType.toUpperCase()} Full Test...</span>
                        </div>
                    `;
                    
                    // Redirect after brief delay
                    setTimeout(() => {
                        if (testType === 'ielts') {
                            window.location.href = '/ielts-instructions.html';
                        }
                    }, 1000);
                }
                
            } catch (error) {
                console.error('❌ Failed to start full test:', error);
                alert(`Error: ${error.message || 'Failed to start test'}. Please try again.`);
            }
        }

        function startIndividualTest(testType, section) {
            console.log('🎮 Starting individual test:', testType, section);
            
            try {
                // Show loading state
                const testCard = event.target.closest('.individual-card');
                if (testCard) {
                    const button = testCard.querySelector('.practice-button');
                    const originalText = button.textContent;
                    button.innerHTML = `
                        <div class="loading-spinner mr-2"></div>
                        Loading...
                    `;
                    
                    // Redirect after brief delay
                    setTimeout(() => {
                        if (testType === 'toefl') {
                            window.location.href = `/toefl-instructions.html?section=${section}`;
                        } else if (testType === 'ielts') {
                            window.location.href = `/ielts-instructions.html?section=${section}`;
                        }
                    }, 1000);
                }
                
            } catch (error) {
                console.error('❌ Failed to start individual test:', error);
                alert(`Error: ${error.message || 'Failed to start test'}. Please try again.`);
            }
        }

        // ============================================================================
        // DASHBOARD INITIALIZATION
        // ============================================================================

        function initializeDashboard() {
            try {
                console.log('🎯 Initializing Voice Dashboard...');
                
                // Load header first
                loadHeader();
                
                // Load user data and stats
                loadUserStats();
                
                console.log('✅ Dashboard initialization complete');
                
            } catch (error) {
                console.error('❌ Dashboard initialization failed:', error);
            }
        }

        function loadUserStats() {
            // For now, using mock data
            // In production, this would fetch from backend
            console.log('📊 Loading user statistics...');
            
            // Update stats with mock data
            document.getElementById('tests-completed').textContent = '5';
            document.getElementById('average-score').textContent = '7.8/9';
            document.getElementById('practice-time').textContent = '12h';
            document.getElementById('improvement').textContent = '+15%';
        }

        // ============================================================================
        // EVENT LISTENERS
        // ============================================================================

        // ============================================================================
        // SMOOTH PAGE TRANSITIONS
        // ============================================================================

        // Add smooth transitions to navigation links
        document.addEventListener('DOMContentLoaded', function() {
            // Add transition class to all navigation links
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    // Only apply transition for internal links
                    if (link.href && !link.href.includes('#')) {
                        e.preventDefault();
                        
                        // Add fade-out effect to current page
                        document.body.style.opacity = '0';
                        document.body.style.transform = 'translateY(-20px)';
                        document.body.style.transition = 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
                        
                        // Navigate after transition
                        setTimeout(() => {
                            window.location.href = link.href;
                        }, 300);
                    }
                });
            });
        });

        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🎯 DOM loaded - initializing dashboard...');
            
            // Add page load animation
            document.body.classList.add('page-transition');
            setTimeout(() => {
                document.body.classList.add('loaded');
            }, 100);
            
            await initializeDashboard();
            console.log('✅ Dashboard fully initialized');
        });
    </script>
</body>
</html> 